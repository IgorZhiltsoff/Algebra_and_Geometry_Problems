\input{../common/preamble_termI}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage[inline]{enumitem} 


\begin{document}
		{\heading{1. Матрицы}}
	
	\begin{problem}
		Вычислить: \\
		\centerline{
			\begin{enumerate*}
				\item $
				\begin{pmatrix}
					1 & 2 & 0 & 0 \\
					3 & 4 & 0 & 0 \\
					0 & 0 & 5 & 0 \\
					0 & 0 & 0 & 5 \\
				\end{pmatrix}
				\begin{pmatrix}
					6 & 0 & 0 & 0 \\
					0 & 6 & 0 & 0 \\
					0 & 0 & 7 & 8 \\
					0 & 0 & 9 & 0 \\
				\end{pmatrix}
				$
					
				\item $
				\begin{pmatrix}
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
					0 & 0 & 0 & 1 \\
					1 & 0 & 0 & 0 \\
				\end{pmatrix}
				\begin{pmatrix}
					0 & 0 & 0 & 1 \\
					1 & 0 & 0 & 0 \\
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
				\end{pmatrix}
				$
				
				\item $
				\begin{pmatrix}
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
					0 & 0 & 0 & 1 \\
					1 & 0 & 0 & 0 \\
				\end{pmatrix}
				\begin{pmatrix}
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
					0 & 0 & 0 & 1 \\
					1 & 0 & 0 & 0 \\
				\end{pmatrix}
				$
				
			\end{enumerate*}
		}
	\end{problem}
	
	\begin{problem}{
		Вычислить в зависимости от $N$: \\
		\centerline{
			\begin{enumerate*}			
			\item \(
			\begin{pmatrix}
				1 & 0 & 0 & 0 \\
				0 & 1 & 0 & 0 \\
				0 & 0 & 1 & 0 \\
				0 & 0 & 0 & 1 \\
			\end{pmatrix}^N
			\)
			
			\item \(
			\begin{pmatrix}
				1 & 0 & 0 & 0 \\
				0 & 2 & 0 & 0 \\
				0 & 0 & 3 & 0 \\
				0 & 0 & 0 & 4 \\
			\end{pmatrix}^N
			\)
			
			\item \(
			\begin{pmatrix}
				0 & 1 & 0 & 0 \\
				-1 & 0 & 0 & 0 \\
				0 & 0 & 0 & 1 \\
				0 & 0 & -1 & 0 \\
			\end{pmatrix}^N
			\)
			\end{enumerate*}
		\begin{enumerate*}[resume]
			
			\item \(
			\begin{pmatrix}
				0 & 1 & 0 & 0 \\
				0 & 0 & 1 & 0 \\
				0 & 0 & 0 & 1 \\
				0 & 0 & 0 & 0 \\
			\end{pmatrix}^N
			\)
			
			\item \begin{math}
			{\begin{pmatrix}
				1 & 1 & 0 & 0 \\
				0 & 1 & 1 & 0 \\
				0 & 0 & 1 & 1 \\
				0 & 0 & 0 & 1 \\
			\end{pmatrix}^N}\end{math}
		
		\end{enumerate*}}
	}
	\end{problem}
	\begin{problem}{	
		Докажите, что существует \textbf{единственная} матрица $E$ такая, что:
			$$\forall A \ \ EA = A = AE$$
	}\end{problem}
	\begin{problem}{	
			А верно ли следующее? ($\exists!$ означает "существует единственный")
			$$\forall A \ \ \exists! E \ \ EA = A = AE$$
	}\end{problem}

	\begin{problem}[K18.1а] Решить систему уравнений:
			$$\begin{dcases}
				$$X + Y \hfill = \begin{pmatrix}
					1 & 1 \\
					0 & 1
				\end{pmatrix}$$ \\
				$$2X + 3Y \hfill = \begin{pmatrix}
					1 & 0 \\
					0 & 1
				\end{pmatrix}$$
			\end{dcases}$$
	\end{problem}
	
	\begin{problem}{	
			Найти парочку матриц с действительными элементами, удовлетворяющих уравнению:
				$$X^2 = -\begin{pmatrix}
					1 & 0 \\
					0 & 1
				\end{pmatrix}$$
	}\end{problem}

	\begin{problem}
		За какую асимптотику работает перемножение матриц "по определению"?
	\end{problem}

	\begin{problem}[Быстрое возведение в степень]
		Нетрудно придумать алгоритм, возводящий матрицу размера $N \times N$ в степень $K$ за $O(N^3K)$. Предложите способ улучшить время до $O(N^3 \log K)$. \\
		\textit{Что ещё можно возводить в степени таким алгоритмом?}
	\end{problem}
	
	\textbf{Откуда вообще взялось такое странное правило умножения матриц? На этот вопрос мы дадим ответ ближе к концу семестра, а пока посмотрим, какие интересные задачи могут быть с ним связаны.}
	
	\subheading{Графы}
	
	\begin{problem}
		В стране $N$ городов, некоторые из которых соединены дорогами (список пар соединённых городов дан). Предложите способ "быстро" посчитать количество путей из города $1$ в город $N$ таких, что:
		\begin{itemize} {
			\item между 1 и $N$ было посещено ровно $K$ городов (необязательно различных или отличных от $1$ и $N$\footnote{Т.е. если мы хотим доехать из города 1 в город 3, суммарно посетив 5 городов, то вполне годится путь 13213 (если есть все требуемые дороги)}.
			\item между $1$ и $N$ было посещено не более $K$ городов (с той же оговоркой).
		}\end{itemize}
		\textit{Работают ли предложенные алгоритмы в случае, если между какими-то двумя городами есть несколько дорог? А если дороги односторонние?}
	\end{problem}

	\begin{problem}{
		Посчитайте количество нулей в матрице: \\
			\centerline{
				$\underset{(100 \times 100)}{\begin{pmatrix}
					1 & 1 & 0 & \cdots & 0 & 0 & 0 \\
					0 & 1 & 1 & \cdots & 0 & 0 & 0 \\
					0 & 0 & 1 & \cdots & 0 & 0 & 0 \\
					\vdots & \vdots & \vdots  & \ddots & \vdots & \vdots & \vdots \\
					0 & 0 & 0 & \cdots & 1 & 1 & 0 \\
					0 & 0 & 0 & \cdots & 0 & 1 & 1 \\
					1 & 0 & 0 & \cdots & 0 & 0 & 1  \\
				\end{pmatrix}^{99}}$
			}
		\textit{Как можно было бы посчитать элемент с координатами $i, j$ в этой матрице?}
		
	}\end{problem}

	\begin{problem}
		Дан граф на $N$ вершинах. Построить его \textit{\textbf{транзитивное замыкание}} (для начала попробуйте догадаться, что это).
		\textit{Интересно, насколько быстро можно решать такую задачу? Оказывается, на разреженных графах можно управиться за $O(N^2)$ (возможно, Вы даже уже можете найти такое решение)! Из известных мне способов наиболее эффективен т.н. алгоритм Пурдома.}
	\end{problem}

	\subheading{Динамическое программирование}

	\begin{problem}
		Предложите способ посчитать $N$-ое число Фибоначчи за $O(\log N)$. 	
	\end{problem}
	
	\begin{problem}
		Предложите способ найти $a_n$, где $a_0 = 1, a_1 = 2, a_n = 3a_{n-1} - 2a_{n-2}$, за $\mathbf{O(1)}$ \textbf{при условии, что битовый сдвиг работает за} $\mathbf{O(1)}$.
		\\
		\textit{Эту задачу Вы ещё решите на ОКТЧ в этом семестре.}
	\end{problem}

	\subheading{След}
	
	\begin{definition}
		След (trace) матрицы $A$ размера $N \times N$ - это сумма её диагональных элементов: 
		$$ \tr A = \sum_{j=1}^{N} a_{jj}$$
	\end{definition}

	\begin{problem}[Одна из возможных мотиваций] 
		\textbf{\\Текст ниже будет гораздо понятнее, когда Вы узнаете об определителях (второго порядка) на лекции.} \\
		В чём интерес следа, скорее всего, пока непонятно. \\
		Такой довольно простой на первый взгляд объект обладает целым рядом интересных свойств. Он ещё возникнет в курсе, а пока заметим вот что: \\
		Наверное, Вы знаете, что такое производная. Покажите, что у следа "есть вайбы" производной определителя второго порядка, а именно для $H$ с "достаточно малыми" элементами верно:
		$$ \detbf (E + H) \approx 1 + \tr H$$
		\textit{$\detbf$ можно обобщить на квадратные матрицы больших размеров. И это свойство сохраняется! Выглядит довольно интригующе - хорошая причина взглянуть на другие свойства следа.}
	\end{problem}

	\begin{problem}
		Начнём с простого, но полезного свойства: убедитесь, что $\tr$  линеен, т.е. (греческие буквы - числа):
		$$ \tr(\alpha A + \beta B) = \alpha \tr A + \beta \tr B$$
		\textit{Если Вы посещали математику в 7 классе, Вы должны были слышать о линейных функциях. Как школьное и вузовское определение линейной функции связаны?}
	\end{problem}

	\begin{problem}
		Пусть $A$ - матрица размера $N \times M$, а $B$ - $M \times N$. Покажите, что:
		$$\tr AB = \tr BA$$
		\textit{Для квадратных матриц это свойство - следсвтие из более общей теоремы из второго семестра.}
	\end{problem}
	
	\begin{problem} [Г7.12]
		Опишите все матрицы $A$ такие, что:
		$$ \forall X \ \ \tr AX = 0 $$
	\end{problem}

	\begin{problem}
		Докажите, что матрица $A$ - корень такого многочлена\footnote{Что? Матрица - корень многочлена? 
			\\ Всё становится вполне прозрачно, если договориться, что скаляр $\alpha$ понимается как $\alpha E$. \\ Это безусловно корректно. Но единственный ли это способ "подставить матрицу в многочлен"? Если бы это было не так, то перед нами встал бы ряд вопросов, берущих начало из "чем, если хоть чем-то, этот способ лучше остальных?"
			\\ Тем не менее в конце семестра мы узнаем, что он действительно единственен. Формально, мы покажем, что для каждой матрицы $A$ существует единственная функция $eval_A$, принимающая многочлен и возвращаюшая матрицу-"значение многочлена на $A$". \\ Более того, мы выясним, "кого ещё можно подставлять в многочлены"... 
			\\ ...но об этом потом.}:
		$$x^2 - \tr A \cdot x + \detbf A$$
		\textit{Этот многочлен называется "характеристическим для $A$". Во втором семестре мы определим характеристический многочлен для матриц произвольного размера. Также мы докажем обобщение этой задачи - теорему Гамильтона-Кэли (матрица произвольного размера - корень собственного характеристического многочлена).\\
		Кстати, заметьте, что любая матрица $2 \times 2$ - обязательно корень квадратного уравнения. А можно ли найти среди матриц решения каких-нибудь линейных уравнений? (Этот вопрос связан с другим важным понятием из второго семестра - минимальным многочленом).} 
	\end{problem}

	\subheading{Алгоритм Штрассена}
	
	Как Вы видите, умножать матрицы \textit{бывает небесполезно}. Пока что мы знаем только один алгоритм (aka определение), причём не очень быстрый. Хотелось бы найти что-то похитрее. Но как? \\
	Впервые эту задачу решил Фолькер Штрассен в 1969 году. Давайте попробуем понять, что он придумал, а главное - как. 
	
	\textbf{Ниже мы будем пользоваться т.н. мастер-теоремой для оценки времени работы рекурс ивных алгоритмов. Если Вы с ней незнакомы, можете, например, посмотреть первую лекцию по алгоритмам Ильи Степанова (основной поток) или прочитать про неё на \href{https://neerc.ifmo.ru/wiki/}{сайте ИТМОшных вики-конспектов}.}
	
	Начнём с парочки вспомогательных фактов.
	
	\begin{problem}
		Пусть:
		\begin{itemize}
			\item $D$ - матрица $2 \times 2$ такая, что:
			\begin{itemize}
				\item $\tr D = -1$
				\item $\detbf D = 1$
			\end{itemize}
		\end{itemize}
		Тогда:
		\begin{itemize}
			\item $D^3 = E$
		\end{itemize}
	\end{problem}

	\begin{definition}
		Пусть:
		\begin{itemize}
			\item $D$ - матрица $2 \times 2$ из предыдущей задачи,
			\item $u$ - вектор-столбец такой, что:
			\begin{itemize}
				\item $Du$ неколлинеарен $u$ \signed {} ($*$).
			\end{itemize}
		\end{itemize}
		Тогда:
		\begin{itemize}
			\item $u^\bot$ - это вектор-строка такая, что:
			\begin{itemize}
				\item $u^\bot u = 0$
				\item $u^\bot D u = 1$
			\end{itemize}
		\end{itemize}
	\end{definition}

	\begin{problem}
		Покажите, что $u^\bot$ существует и единственен $\iff$ $u$ удовлетворяет $(*)$.
	\end{problem}

	Дальше мы негласно предполагаем, что $D$ и $u$ обладают свойствами, оговоренными выше.

	\begin{problem}
	\todo{Express in terms of u and D?}	Покажите, что $(Du)^\bot = u^\bot D^2$. 
	\\ \textit {Не забудьте убедиться, что $Du$ удовлетворяет $(*)$.}
	\end{problem}

	\begin{problem}
		Покажите, что $u^\bot D^2 u = -1$.
	\end{problem}

	\begin{problem}
		Пусть:
		\begin{itemize}
			\item 
		\end{itemize}
	\end{problem}
\end{document}